For example a recent study compar- ing different approaches of mapping sequencing reads to functional categories concluded that the variation intro- duced by the choice of mapping approach outweighed underlying variation between sampled individuals In addition we recently found that a routinely used metagenomic normalization method could introduce spurious variation into the functional profile of micro- biome samples It is therefore plausible that com- monly employed computational methods for processing metagenomic data could similarly impact the functional variation observed in the microbiome.Here we set out to examine this hypothesis and to detect specific computational practices used in the pro- cessing of metagenomic data that could mask important variation across microbiome functional profiles.

Combined these find- ings suggest that the variation uncovered by MUSiCC likely represents real and biologically relevant variation.Inclusion of prevalent bacterial gene familiesClearly whereas some gene families are encoded by a limited number of bacterial species and represent unique metabolic capacities or adaptations other gene families are extremely prevalent and can be found in almost any bacterial genome.

MUSiCC uses a set of universal single- copy marker genes as a yardstick to calibrate gene family abundances across samples representing the prevalence of each gene family in a sample as the average copy number of this gene family across all genomes in the sample rather than as its relative abundance.

Excluding such gene families may therefore facilitate the identification of subtle differences between individuals' microbiomes that might play a role in host phenotypic variation.Aggregation of gene families into pathwaysTo gain a more interpretable and biologically meaningful result in comparative functional metagenomic analysis re- searchers routinely aggregate gene families into higher- level functional categories such as metabolic or structuralpathways.

Im- portantly this finding could not be explained solely by the fact that genome co-occurrence-based aggregates tended to exhibit a different size distribution than KEGG pathway-based aggregates Additional file Figure S5.Quantification of the contribution of shared gene families to pathway abundanceAs discussed above in most functional metagenomic studies gene abundances are converted into pathway-level profiles representing the aggregated abundances of gene families associated with each pathway.

The abundance of such a shared gene family is usually uniformly assigned to all pathways with which it is associ- ated either by dividing the abundance of this gene family uniformly across these pathways referred to below as uni- form fractional mapping or by adding the entire gene family abundance to each pathway referred to below as uniform complete mapping see for example Ref.

Specifically the standard pipeline usedrelative abundance normalization considered all gene families associated with each pathway and applied uniform mapping of gene families to pathways whereas the revised pipeline in contrast used MUSiCC for normalization fil- tered prevalent gene families and applied the non-uniform mapping scheme described above.

We specifically identify four different such practices namely relative normalization the inclusion of prevalent bacterial genes gene aggregation and gene mapping schemes that contribute to functional variation masking.

Indeed we found that applying MUSiCC normalization resulted in a markedly increased correlation of R  0.34 P  10-3 Mantel test and that re- moving all genome-prevalent gene families from the MUSiCC-corrected functional profile and using genomic co-occurrence-based aggregation of gene families further increased the correlation to R  0.36 and R  0.41 respect- ively P  10-3 for both Mantel test.Given the temporal consistency in inter-individual variation we finally examined whether metagenomic functional profiles can uniquely identify an individual in the second visit based on samples collected in the first visit.

In contrast including genome- prevalent gene families in the calculation of functional profiles or aggregating gene families based on potentially arbitrary functional annotations rather than based on genomic co-occurrence patterns reflect conceptual data analysis approaches that are not necessarily unjustified but do impact measured variation.


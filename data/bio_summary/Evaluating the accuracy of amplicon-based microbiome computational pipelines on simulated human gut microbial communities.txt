the default qiime settings for preprocessing were used including filtering out sequences that had any ambiguous bases or homopolymer runs longer than 6. for simulated 454 sequences the length requirement was modified to be between 200 and 1000 and a more lenient maximum ambiguous base of 6. the communities where errors were introduced had either a minimum aver- age quality score of 25 or a minimum phred quality score of three and truncation at three consecutive poor quality base calls.we used three otu picking strategies with default parameters de novo closed and subsampled open- reference in de novo sequences are clustered into centroids with each cluster fulfilling the 97 identity with uclust version 1.2.22q or with a local difference of one with swarm  a representative se- quence for each otu is aligned with pynast to a reference set for taxonomy assignment either green- genes  version 13.8 or silva version 119 indow miseq data or trim sequence with average quality score drops below 30 over a 50 base window 454 data.

each otu or clustered-together set of sequences is meant to represent an organism in the initial community suitable for unit measures of community diversity for correlation analysis and for classification to a named organism.there are three broad strategies used to generate otus closed otu generation strategies align to a reference set and cluster all amplicons aligning to the same reference sequence.

in our preliminary studies we used 16sssu rrna exclusively from reference organisms or complete genomes to generate our synthetic reads without simulated pcr or sequencing errors even in this very ide- alized circumstance classification success was limited in a similar way to the data presented here.we speculate duplicated misannotated and imperfectly sequenced entries in reference databases contribute to classification errors.

for each simulated amplicon one read with sequencing error was generated.calculation of species diversity of real and synthetic dataas per we used the formula 1 closed otu picking sequences were queried against the reference database greengenes version 13.8 at the default 97 identity with uclust for clustering uclust classifier with silva version 119 97 otu or swarm classifier with greengenes version 13.8. in sub-sampled open-reference otu picking sequences were first queried against the reference database greengenes version 13.8 and if matched they were classified with uclust fast uclust settings.

these cluster centroids were used as new reference otus for the remaining pool of sequences that had not matched an otu in the reference database.

following recruitment of reference sequences speciesshannon diversity and pairwise distance calculation shannon diversity and pairwise distance calculations were completed via the phyloseq package in r. for tree-based distance metrics unifrac dpcoa a phyl- ogeny was generated to be used as a 'true' phylogeny with raxml from an alignment generated by cmalign of the full length source 16s ssu rrna sequences from which the amplicons were generated in-silico to create the community.additional filesthat were the only representatives of a genus were iden- tified as lonely taxa additional reference sequences representing closely related species from the same genus were added using deenurp filllonely with default param- eters to provide additional taxonomic context.

mothur uses a unique approach including dereplication alignment to the silva reference database further dereplication and finally clustering with uclust we consider this a closed strategy given the discarding of sequences that do not align to the silva reference.

the right column is pairwise distances as calculated by double principle coordinate analysis dpcoacannot assess how pipelines handle novel organisms nor is it ideal for testing pcr or sequencing errors.even with these limits for healthy human stool-like communities we discovered careful selection of reference sets curation of reference sets and improved otu gener- ation techniques can all improve the accuracy of results.

each genus is also given parameters either a mean and standard deviation number of species to be in- cluded for this genus or parameters a b for the log functionn 14 a  logdf th th bwhere n is the number of species f is the fractional abundance of this organism in the community.using these parameters the module selects specific reference sequences and then calculates the fraction of the community that this specific reference sequence and organism represents.in-silico pcr and amplicon generationthe generatesequences.py module of decard takes the target file generated in the community creation step a desired read depth and a fasta file containing the primer sequences and performs in-silico pcr to gen- erate amplicons with a known origin.

alternative runs of subsampled open reference otu picking included using silva version 119 as reference database.mothur classificationmothur version 1.36.1 was employed following the standard operating procedures from the website.

the 14.0 revision of the rdp reference database in turn culled from the ncbi databases was broken down into reference sequences with well- formed species names e.g.

thus specific details of how a pipeline is used including otu generation strategy reference sets clustering algorithm and specific software implementation should be specified in the methods section of all microbiome studies.

even within a given analysis pipeline there are a variety of settings to be selected which otu generating strategy should be used which clustering algorithm which classifier and reference databaseusing constructed mock-communities as a gold-standard allows for a detailed assessment of the effects of dna stor- age extraction pcr enzymes and primers sequencing technique and classification software.

in-silico data has been used to optimize the pcr pri- mer selection process  6 and identify misidentified sequences .despite all of this excellent work it remains a challenge for a researcher performing a microbiome experiment a reviewer critically evaluating a study for publication or a reader considering the validity of the study to determine which pipeline selected otu strategy reference database and classification tactics are the best--or even adequate in accuracy and precision--to support the conclusions of the study.

reference set or algorithm used.


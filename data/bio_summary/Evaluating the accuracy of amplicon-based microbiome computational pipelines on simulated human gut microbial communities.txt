Following recruitment of reference sequences speciesShannon diversity and pairwise distance calculation Shannon diversity and pairwise distance calculations were completed via the Phyloseq package in R. For tree-based distance metrics UniFrac DPCoA a phyl- ogeny was generated to be used as a 'true' phylogeny with RaXML from an alignment generated by cmalign of the full length source 16S SSU rRNA sequences from which the amplicons were generated in-silico to create the community.Additional filesthat were the only representatives of a genus were iden- tified as lonely taxa additional reference sequences representing closely related species from the same genus were added using deenurp filllonely with default param- eters to provide additional taxonomic context.

When mul- tiple sequences were available for a given species all of the sequences for a given species were clustered and outliers dropped--defined as sequences greater than the 90th percentile in distance from the nearest centroid using the deenurp  package in filter outlier mode.Stool microbiome estimationThe mean and standard deviation of relative abundance of genera from a random selection 100 of stool micro- biomes from the NIH Human Microbiome Project and from healthy hematopoietic stem cell donors were used to determine the composition of a typical stool microbiome.Defined community creationThe generatetargets.py module picks specific sequences and their relative abundance to generate com- munities.

The preprocessed sequences were de-duplicated and aligned to a 50000-column wide SILVA-based reference database Silva version 123 previously trimmed to the section of 16S rRNA genes amplified by the PCR primer used to generate the amplicons using a NAST-based aligner.Aligned sequences were filtered to remove any se- quences that contain just gaps and this was done prior to deduplication and a merge of all sequences that had two or fewer base pairs different.

Each genus is also given parameters either a mean and standard deviation number of species to be in- cluded for this genus or parameters a b for the log functionn 14 a  logdf Th th bWhere n is the number of species f is the fractional abundance of this organism in the community.Using these parameters the module selects specific reference sequences and then calculates the fraction of the community that this specific reference sequence and organism represents.In-silico PCR and amplicon generationThe generatesequences.py module of DECARD takes the target file generated in the community creation step a desired read depth and a FASTA file containing the primer sequences and performs in-silico PCR to gen- erate amplicons with a known origin.

The resultant representative sequences were then used to recruit sequences from the named reference set using deenurp selectreferences with default parameters.

Each OTU or clustered-together set of sequences is meant to represent an organism in the initial community suitable for unit measures of community diversity for correlation analysis and for classification to a named organism.There are three broad strategies used to generate OTUs Closed OTU generation strategies align to a reference set and cluster all amplicons aligning to the same reference sequence.

These cluster centroids were used as new reference OTUs for the remaining pool of sequences that had not matched an OTU in the reference database.

The communities where errors were introduced had either a minimum aver- age quality score of 25 or a minimum Phred quality score of three and truncation at three consecutive poor quality base calls.We used three OTU picking strategies with default parameters de novo closed and subsampled open- reference In de novo sequences are clustered into centroids with each cluster fulfilling the 97 identity with Uclust version 1.2.22q or with a local difference of one with Swarm  a representative se- quence for each OTU is aligned with PyNAST to a reference set for taxonomy assignment either Green- Genes  version 13.8 or Silva version 119 Indow miseq data or trim sequence with average quality score drops below 30 over a 50 base window 454 data.

All of these pipelines take con- sensus amplicon sequences from each OTU aligned against a set of named reference sequences based on the alignment scores names and taxonomies are se- lected for each OTU.

Further an amplicon sequence can match multiple reference database entries with different taxonomic classifications due to duplicated sequences and the amplicon region sequence being shared between distinct full-length sequences.


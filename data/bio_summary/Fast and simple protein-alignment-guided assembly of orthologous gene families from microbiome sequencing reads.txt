microbiome 2017 511doi 10.1186s40168-017-0233-2fast and simple protein-alignment-guided assembly of orthologous gene families from microbiome sequencing readsdaniel h. huson12 rewati tappu1 adam l bazinet34 chao xie5 michael p. cummings3 kay nieselt1 and rohan williams2backgroundfunctional analysis of microbiome sequencing reads--by which we mean either metagenomic or metatranscrip- tomic shotgun sequencing reads--usually involves align- ing the six-frame translations of all reads against a protein reference database such as ncbi-nr  using a high-throughput sequence aligner such as diamond each read is then assigned to a functional family such as a kegg ko group or interpro family based on the annotation of the most similar protein ref- erence sequence.a gene-centric assembly for a family of orthologous genes f is the assembly of all reads associated with f. one approach to this is simply to run an existing assembly tool on the reads.

the net effect is that reads are filtered and trimmed not based on some arbitrary quality valued- associated thresholds as with standard read trimming and filtering procedures but rather based on the outcome of alignment as protein sequence to reference genes.we emphasize that overlaps between reads are not only inferred from alignments to just one particular reference sequence which would be a simple reference-guided assembly but rather each read usually participates inoverlaps that are induced by alignments to a number of different reference proteins typically orthologous proteins from different organisms.

showing that the protein-alignment- based assembler implemented in megan performs best for most genes.table 1 for each gene family studied we report the kegg orthology group number of reads assigned to that group by diamond number of reference gene sequences that exist in the synthetic community and number of reference genes detected by each method megan idba-ud ray soapdenovo and xandertable 1 for each gene family studied we report the kegg orthology group number of reads assigned to that group by diamond number of reference gene sequences that exist in the synthetic community and number of reference genes detected by each method megan idba-ud ray soapdenovo and xander continuedbest results are shown in bold.

increasing the threshold to 99 produces ahandful of additional correct gene detections while roughly doubling the number of contigs.gene-centric assembly does not replace the computa- tion of a full assembly of all reads which remains a chal- lenging problem with some recent advances diamond alignment of all 108 million reads in the synthetic community  against the ncbi-nr database followed by the gene-centric assembly of all 2834 detected kegg families using megan took only one and a half days on a single 32-core server.

this indicates that there are only very few if any false positive contigs.to assess assembly performance for each assembly each gene family and each species in the synthetic com- munity that contains a member of the gene family we determined the percentage of reference gene sequence covered by the longest contig aligned to it fig.

in our evaluation we find that the megan assembler performs best in terms of the percentage of reference genes covered and percentage of reference gene sequences detected.methodsthe main technical contribution of this paper is the design and implementation of a protein-alignment-guided as- sembly algorithm that is explicitly designed for gene-centric assembly.

in this paper we present a new approach to gene-centric assembly that we call pro- tein-alignment-guided assembly.

protein-alignment-guided assembly makes use of pre-computed protein alignments to perform gene- centric assembly.

alternative ways of performing gene- centric assembly include running an external assembly tool on the reads assigned to a specific gene family or using an hmm-based framework such as xander for read recruitment and assembly.based on percent coverage by longest contig and num- ber of gene sequences detected the megan assembler performs best in our experimental study figs.

the built-in assembler now provides such users with simple access to sequence assembly techniques on a gene-by-gene basis.acknowledgementswe thank alexander seitz for helpful discussions.fundingthis work was supported by the graduate school of the university of maryland college park and the institutional strategy of the university of tubingen deutsche forschungsgemeinschaft zuk 63 and by the life sciences institute of the national university of singapore.availability of data and materialsour implementation of protein-alignment-guided assembly presented in this paper is available in the community edition of megan which may be down- loaded here the alignments computed by diamond on the synthetic community can be accessed from within megan by connecting to the public meganserver database and opening the file named othersynthetic-shakya- 2013.daa.authors' contributionsall authors contributed to the study design.

let r denote the set of all reads that are assigned to f based on a diamond alignment of all reads against a protein reference database such as ncbi-nr or kegg.our assembly approach is based on an overlap graph.

we also plot the average percent coverage per gene family for all assemblersand the absence of any directly corresponding refer- ence sequences.note however that there are a number of other spe- cies bacteroides vulgatus desulfovibrio piger gemmati- monas aurantiaca and salinispora arenicola for which there is no directly corresponding reference sequence for any of the 41 kos yet for these the gene-centric assembly appears to work well.

in table  for each gene and each assembler we report the number of reference sequences detected as defined above and provide a summary of the pro- portion of reference sequences detected per gene family in fig.

the ncbi-nr database contains 1700 reference proteins for this species and so the average number of reads assigned to each protein is only 27. in addition none of these reference sequences is annotated by one of the 41 kos kegg orthology groups used in this study.

for each assembler each gene family rows and each reference gene sequence associated with a species in the synthetic community columns we indicate the percentage of the reference gene covered by the longest contig.


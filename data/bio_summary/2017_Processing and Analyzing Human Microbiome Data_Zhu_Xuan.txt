the number of species with exactly two occurrences in the sample and is calculated as follows Suppose Sobs is thenumber of species for the sample A1 is the number of singletonsand A2is the number of doubletons then Chao1a14 SobsA122A22higher estimated value represents more diversity within the sample.The Chao1 a diversity index is particularly useful for microbiome datasets skewed to low abundance classes while a drawback of the Chao1 a diversity index is that when the sample size is low it underestimates the true value .Abundance-Based Coverage EstimatorThe abundance-based coverage estimator ACE   measures the a diversity by separating the species into two groups an abun- dant species group and a rare species group.

1 Flowchart of basic steps in handling raw microbiome sequencing dataraw microbiome sequencing data and extracting the OTUs using QIIME are provided in Subheading .Demultiplexing If multiple samples are pooled in one single lane by using the sample index or barcode adapters then the step of demultiplexing is needed to divide one file of sequencing reads into separate files where one file corre- sponds to one sample .Removing barcodes High-throughput sequencing allows multiple different independent samples to be sequenced dur- ing a single run.

The following command can be executed to combine all the fastq files into one.Input files 1 directory of multiple fastq read files 2 parame- ter file.Output files directory of output files including seqs.fna file which are used to select OTUs.multiplesplitlibrariesfastq.py -i input directory -p file path or name of parameter file -o output directoryFor data in fasta format.Quality filtering can be conducted by following the three steps described below.Step 1 Clean the data to remove the incompatible lines and make the file compatible with QIIME see Note 2.Input files fasta read files.Output files directory of output fasta files.cleanfasta.py -f read file name -o output file direc- toryStep 2 Use splitmetadata.py and splitlibrary.py to transform from the previous combined fasta file format into another fasta format by parsing the sequences that meet user-defined quality thresholds and then renaming each read with the appropriate sample ID  .Step 3 Concatenate all the fasta files using cat in Linux.Input files multiple fasta read files.

For example in Table  the weighted UniFrac dissimilarity between sample SRR1023240 and sample SRR1023582 is 0.37 and the weighted UniFrac dissimilarity between sample SRR1023263 and SRR1023240 is 0.41.Normalized Unweighted UniFrac Measure unweightedunifnorm-UniFracbiomsample weighted14FALSE normalized14TRUETable shows the results for the normalized unweighted Uni- Frac dissimilarity which is 0.82 between sample SRR1023460 and sample SRR1023240 and 0.80 between sample SRR1023240 and sample SRR1023582.Normalized Weighted UniFrac Measure weightedunifnorm-UniFracbiomsample weighted14TRUE normalized14TRUETable 7Normalized weighted UniFrac measure for the foregut esophageal adenocarcinoma datasetTable provides the results of the normalized weighted Uni- Frac measure for the foregut esophageal adenocarcinoma dataset.

The calculation of the ACE is described below .Given that f1 is the number of singleton species fk is thenumber of species with exactly k taxa and Sobs is the total number of species in the sample the number of rare species is described asSrare 14 P10 f  and the number of abundant species is denoted askSabund 14 PSobsf k assuming the value of 10 is the threshold.

X 0 nAj th nBj log nAj thnBj  - nAj log nBj - nBj log nAj 1 where nAj is the counts of taxa for species j in sample A nBj is the counts of taxa for species j in sample B and N is the total number of species present in the two samples.In this formula the numerator summandnAj th nBjthe dissimilarity between two samples.

All reads in the sample are clustered by the open-reference approach .Input files fasta file seqs.fna.Output files directory of output files including a phylogenetic tree file and a biom-formatted OTU table.pickopenreferenceotus.py -i input read file -o output directory nameSummary of the OTU TableAfter selecting the OTU we can summarize the generated OTU table in terms of the number of samples the number of observa- tions and a summary of the total counts observed for each sample .

The metadata mapping file usually contains the following information the name of each sample barcode sequence for each sample primer sequence used to amplify the sample and a descrip- tive column for example health status sampling site or which medications a patient was taking at the time of sampling .Figure shows the basic procedure for processing the raw microbiome sequencing data.

Output files directory of output files including seqs.fna demultiplexedsequences.log seqs.qual and seqsnotas- signed.fnademultiplexfasta.py -f read.fasta file -m metadata mapping file -o output directory nameFor data in fastq formatThe function of splitlibrariesfastq.py can demultiplex sequences from a data file in the fastq format in which the barcodes and sequences are stored in two separate fastq files .Input data files 1 read.fastq file 2 barcode fastq file.

This can be used for data in both fasta and fastq formats.Input files read file.Output files new file with primer removed.use strict use warnings use Cwdmy fwprimers 14 AGAGTTTGATCCTGGCTCAG TACGGRAGGCAGC AG GCCAGCAGCCGCGGTAA AGGATTAGATACCCT GAATTGACGG GGRCCC GYAACGAGCGCAACCCmy dir 14 getcwd opendirDIR dir or die while my file 14 readdirDIR  next if file 14 mnext if file 14 m. print fileopenIN file or die my outfile 14 dePrimer.file openOUToutfilewhilemy line 14 INforeach my aprimer fwprimersline 14saprimergline 14sg print OUT line closeOUT closeINclosedirDIR exit 02.


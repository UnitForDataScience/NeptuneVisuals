The Supplementary Material further in- cludes the results of running MetaCache with database G2 on the simulated metagenomes presented in which are further evidence of MetaCache's high classification accuracy.Runtime and memory consumptionRuntime and memory consumption for classification are measured on a system with a Xeon E5-2683v4 CPU with 128 GB of DDR4 RAM while runtime and memory consumption for database con- struction are measure on an AMD Opteron 6272 CPU with 512 GB of DDR3 RAM.We compared the classification speed and the peak memory con- sumption during classification of the default versions of Kraken CLARK and MetaCache in single-threaded mode using five Illumina read datasets with read lengths ranging between 80 and 250 bps using the database for G1.

MetaCache is executed in default mode using k 14 16.shows precision sensitivity and F1-score at species and genus level as well as the total percentage of classified reads on any level for MetaCache and Kraken and on genus level for CLARK using the three reference genome sets G1 G2 G3 and the three metagenomic read sets HiSeq MiSeq and Skin9.

Another filtration strategy would select all k-mers whose hash val- ues are multiples of the subsampling factor m 14 4sequence ACTGACTG4-mersACTGhashACTG 14 14CTGAhashCTGA 14 8- select TGAChashTGAC 14 7GACT hashGACT 14 11 ACTG hashACTG 14 14This approach selects on average every mth k-mer but does not guar- antee that we sample the sequence in a uniform manner.

In our example we would select the following two 4- mers for s 14 2sequence ACTGACTG4-mersACTGhashACTG 14 14CTGAhashCTGA 14 8 - select TGAC hashTGAC 14 7 - select GACT hashGACT 14 11ACTG hashACTG 14 14Despite being only a minor modification of the second subsampling approach where we select all k-mer hashes which are multiples of the subsampling factor m minhashing exhibits a desirable mathem- atical property.

GenusClass-level classification accuracy and total assignment percentage on all levels for MetaCache up to class level for CLARK for three real-world datasetsBest precision sensitivity and F1-score values for each reference genome set are indicated in bold.the amount of available reference genome data continues to grow rapidly.The subsampled database for CLARK CLARK-k31-8x for G2 has a similar size in memory than the MetaCache default database for G2.

In addition MetaCache can exploit the parallelism of modern multi-core CPUs using multiple threads to classify a number of read batches in parallel.ResultsExperimental setupTo test scalability with respect to memory consumption and accuracy of different read classifiers we have created databases for reference genome sets of varying size for the three tested tools MetaCache Kraken v.0.10.5-beta CLARK v.1.2.3 on a workstation with 512 GB RAM using their respective default parameter settings.G1 contains RefSeq Release 73 complete genomes 4696 bac- terial 5765 viral and 231 archaeal genomic sequences with a total of 9.8  109 bases.

Our experimental results further show that classification accuracy continuously improves when increasing the amount of utilized reference genome data.ApproachWhile it has been shown that fast k-mer indexing and look-up can effectively accelerate taxonomic read assignment current state-of- the-art software tools such as Kraken and CLARK still have a few shortcomingsMemory consumption The index data structure storing the k-mers of each reference genome is usually very large e.g.

The annotated reads were then classified with MetaCache using the G2 and G3 databases and with CLARK using the G2 database on genus and class levels.Classification accuracyConsider a taxonomic rank T e.g.

shows precision sensitivity and F1-score at genus and class level as well as the total percentage of classified reads on any level for MetaCache and on class level for CLARK using the refer- ence genome sets G2 and G3 and the three metagenomic real-world datasets DORA cg102 and 2500cug.

In this example the classification result would be genome G1 as it has 7 hits in the contiguous windows range w2 w3 while G2 has only 1 hit in each of two distant windows w1 and w4 and G3 has only 2 hits in the contiguous range w4 w5The s default s 14 16 smallest of the resulting hash values of thegmax is the size of the longest reference genome in base-pairs.


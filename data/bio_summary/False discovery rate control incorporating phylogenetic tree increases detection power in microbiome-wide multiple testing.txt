To summarize when the phylogenetic tree is informative our procedure dominates BH and ST procedure and when the tree is not informative our procedure is comparable to BH and ST procedure.Real data applicationWe demonstrate our method using a real microbiome dataset from a study of long-term dietary effects on the human gut microbiomeTable 1.

Despite much progress in multiple testing procedures such as false discovery rate FDR control methods that take into account the phylogenetic tree are largely limited.Results We propose a new FDR control procedure that incorporates the prior structure information and apply it to microbiome data.

The ST procedure fixes a threshold value t esti- mates the FDR and chooses t so that the estimated FDR is no larger than a In ST procedure the proportion of null hypothesis is esti- mated through a conservative estimator p0dkTh14 fpi  k i 14 1 ...  mgmd1 - kTh where k is a tuning parameter.

plots the number of identified OTUs with different FDR levels based on our procedure BH procedure and ST procedure.

We then repeated the simulations S1-S5 and compared our procedure to BH and ST. We found that our procedure not only has conservative FDR control under data correlation but also has a much higher power than BH and ST for phylogeny-informative scenarios.Our method is quite flexible and users can specify the prior struc-ture in terms of feature-to-feature distance matrix e.g.

BH procedure is conserva- tive and ST procedure has actual FDRs closer to the nominal ones than BH procedure as the proportion of null hypothesis has been incorporated in ST procedure.

The actual FDR at the nominal FDR level 0.01 0.05 and 0.10Note GBH-20 is the GBH procedure based on 20 pre-specified groups.

We use an empirical Bayesian approach to estimate hyperpar-Permutation-based FDR control algorithmIn this section we use permutation to develop an FDR control pro- cedure based on  The advantage of using permutation is that it adjusts to the unknown null distribution of the test statistic and is robust against different types of dependence such as the correlations in the data dzjlTh even when the working models 3 and 4 are mis- specified.

The data correlation has been shown to affect the performance of many FDR procedures including the popular BH procedure .

We also provide a more generic func- tion 'structFDR' which accepts a distance matrix among features in- stead of a tree to perform structure-based FDR control for other genomic data as long as a distance metric is defined between fea- tures.


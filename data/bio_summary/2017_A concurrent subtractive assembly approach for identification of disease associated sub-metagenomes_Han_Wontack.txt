the results indicate that cosa outperforms sa for detecting minor but consistent effect when multiple samples are used and that using more samples by cosa results in better assembly of the differential genomes cosa-10 10 samples were used cosa-5 5 samples were used.han et al.page 15summary of the simulated and t2d datasets.table 1han et al.page 16table 2evaluation of cosa using simulated datasets community structure and reads extraction.asimulated population 1brelative abundance of the f. acidarmanus genome in population 1c0 reads were extracted out of 38568 reads from the f. acidarmanus genome in p1.han et al.page 17table 3summary of subtractive assembly results of the t2d datasets.p-value0.2 and voting threshold0.8 were used for reads extractionaonly counted genes assembled from extracted reads from patients but not healthy individuals.table 4comparison of the accuracy of t2d prediction using microbial genes derived by cosa and sa.cosaasa uses ratios of k-mer counts to determine differential k-mers bgenes were selected using l1-based feature selection method cno feature selection was applied for this casedaverage accuracy using 10-fold cross-validation.

a svm classifier built upon the microbial genes detected by cosa from the t2d datasets can accurately discriminates patients from healthy controls with an auc of 0.94 10-fold cross-validation and therefore these differential genes 207 genes may serve as potential microbial marker genes for t2d.keywordsmetagenome concurrent subtractive assembly wilcoxon rank-sum test comparative metagenomicsintroductionthe human body is host to trillions of bacteria cells outnumbering human cells by 1.3 to 1 in contrast to the widely cited 101 ratio according to a recent estimate 40. moreover the genes encoded by human microbiome are hundreds of times more than the human complement 47. it has been reported that those microorganisms are involved in 20 ofthese authors contributed equally to this work.han et al.page 2human malignancies 6. the gut microbiota has been linked to a variety of conditions including inflammatory bowel disease 23 cardiovascular disease 19 rheumatoid arthritis 38 parkinson's disease 37 autism spectrum disorder 16 colon cancer 9 39 and liver cirrhosis 34 among others.

we pooled the genes derived from cosa 1008068 genes and sa 1648016 genes resulting a collection of 2656084 genes and futher quantified the abundances of the genes in this collection.

by storing the counts on the disk we can load the counts of k-mers in batches and therefore significantly reduce the memory requirement for recording the counts of all k-mers in every sample.identification of differential k-mers using wilcoxon rank-sum testcosa by default loads 107 k-mers into a two-dimensional array each time and iteratively tests if the frequencies of each k-mer are differential between the two groups of samples.

in addition sa picks up genes in species which only appear in a few samples but with high abundances as a result many of the differential genes assembled are not actually consistently abundant across samples in the same group.

0.001 works well for this simulated case however for real microbiome datasets that have more complex population structure a less stringent p-value cut-off might be needed for differential reads extraction because of the sharing of k-mers among species as shown in the application of cosa to the t2d microbiomes see below.we further compared the assembly quality for the differential genomes with different number of samples with the help of quast 12 and mumer 21. for the s. thermophilus lmd-9 genome in the same sample as above we recovered 95.76 of the reference genome when 10 samples per population were used but only 73.32 of the genome were assembled when we used 5 samples for each group see figure 2 for the comparison.

identified 15 optimal marker genes from the gut microbiome in liver cirrhosis by comparing 98 patients and 83 healthy control individuals 34. based on only the 15 biomarkers they were able to construct a classifier that can discriminate patients with a decent accuracy 34. similarly gut microbiota was explored to detect colorectal cancer and a metagenomic classifier was trained using the taxonomic abundances of 22 marker species 45. the typical workflow of these marker- gene surveys is to assemble the metagenomes and then predict the genes potential marker genes can then be identified by detecting significant differences in their distribution across healthy and disease populations.

in order to identify differential genes protein coding genes were predicted from the contigs using fraggenescan 35 version 1.30.to estimate the abundance of the genes all the reads from each sample were aligned against the gene set by using bowtie 2 22version 2.2.6. we counted a gene's abundance based on the counts of both uniquely and multiplely mapped reads.

the advantage of using this setting we called it strict is that only a small number of reads were extracted and only a small number of genes need to behan et al.page 9quantified and used for building classifiers and it still achieves reasonable prediction accuracy.on the other hand a much larger collection of microbial genes may make feature selection a more serious problem for building predictors and therefore compromise the accuracy of predictors trained using these microbial genes.

also sa can improve the quality of metagenomic assembly when only a subset of closely-related genomes change in their abundances between the groups of samples in comparison.application of sa to gut metagenomes from women with type 2 diabetes t2d 17 reveals compositional features and a large collection of unique or abundant genes in t2d gut metagenomes some of the genes identified by sa were otherwise missed by direct assembly of the original datasets.

therefore additional profiling of gene abundance is required in order to search for genes consistently more abundant in one group versus the other.in this paper we further developed the subtractive assembly approach for the detection of consistently differential genomes or genes by using k-mer frequencies in individual samples co-abundance.

although reads extraction by cosa resulted in a smaller collection of microbial genes than the sa approach since cosa retained much fewer reads than sa genes from cosa tend to be more consistently differential across the samples between the groups.

some of the functions and associated pathways are consistent with what we observed based on sa 42 including murein hydrolases protein id k87 534 1 134  and multidrug resistance efflux pumps protein id k87 34893 1 275 -.discussionwe developed a pipeline based on cosa which efficiently extracts reads that are likely sequenced from differential genes across samples for the identification of conserved microbial marker genes.

moreover we applied it to analyzing t2d gut metagenomes to identify microbial marker genes based on which we built a classifier that accurately discriminates patients from healthy controls.materials and methodsoverviewconcurrent subtractive assembly cosa is designed to identify the short reads that make up the conservedconsistent compositional differences across multiple samples based on sequence signatures k-mer frequencies and then to only assemble the differential readshan et al.page 4aiming to reveal the consistent differences between two groups of metagenomic samples e.g.

the results show that cosa extracted more reads from the differential genomes by using more samples figure 1. for example using a p-value cut-off of 0.005 cosa extracted 593739 99.98 out of 593858 short reads expected for the s. thermophilus lmd-9 genome when 10 samples were used see table 2. when using only 5 samples for each population cosa could only extract 471786 79.44 reads.


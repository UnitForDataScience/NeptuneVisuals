The results indicate that CoSA outperforms SA for detecting minor but consistent effect when multiple samples are used and that using more samples by CoSA results in better assembly of the differential genomes CoSA-10 10 samples were used CoSA-5 5 samples were used.Han et al.Page 15Summary of the simulated and T2D datasets.Table 1Han et al.Page 16Table 2Evaluation of CoSA using simulated datasets community structure and reads extraction.asimulated population 1brelative abundance of the F. acidarmanus genome in population 1c0 reads were extracted out of 38568 reads from the F. acidarmanus genome in P1.Han et al.Page 17Table 3Summary of subtractive assembly results of the T2D datasets.p-value0.2 and voting threshold0.8 were used for reads extractionaonly counted genes assembled from extracted reads from patients but not healthy individuals.Table 4Comparison of the accuracy of T2D prediction using microbial genes derived by CoSA and SA.CoSAaSA uses ratios of k-mer counts to determine differential k-mers bgenes were selected using L1-based feature selection method cno feature selection was applied for this casedaverage accuracy using 10-fold cross-validation.

We pooled the genes derived from CoSA 1008068 genes and SA 1648016 genes resulting a collection of 2656084 genes and futher quantified the abundances of the genes in this collection.

By storing the counts on the disk we can load the counts of k-mers in batches and therefore significantly reduce the memory requirement for recording the counts of all k-mers in every sample.Identification of differential k-mers using Wilcoxon rank-sum testCoSA by default loads 107 k-mers into a two-dimensional array each time and iteratively tests if the frequencies of each k-mer are differential between the two groups of samples.

A SVM classifier built upon the microbial genes detected by CoSA from the T2D datasets can accurately discriminates patients from healthy controls with an AUC of 0.94 10-fold cross-validation and therefore these differential genes 207 genes may serve as potential microbial marker genes for T2D.Keywordsmetagenome concurrent subtractive assembly Wilcoxon rank-sum test comparative metagenomicsIntroductionThe human body is host to trillions of bacteria cells outnumbering human cells by 1.3 to 1 in contrast to the widely cited 101 ratio according to a recent estimate 40.

In addition SA picks up genes in species which only appear in a few samples but with high abundances as a result many of the differential genes assembled are not actually consistently abundant across samples in the same group.

In order to identify differential genes protein coding genes were predicted from the contigs using FragGeneScan 35 version 1.30.To estimate the abundance of the genes all the reads from each sample were aligned against the gene set by using Bowtie 2 22version 2.2.6.

The advantage of using this setting we called it Strict is that only a small number of reads were extracted and only a small number of genes need to beHan et al.Page 9quantified and used for building classifiers and it still achieves reasonable prediction accuracy.On the other hand a much larger collection of microbial genes may make feature selection a more serious problem for building predictors and therefore compromise the accuracy of predictors trained using these microbial genes.

Also SA can improve the quality of metagenomic assembly when only a subset of closely-related genomes change in their abundances between the groups of samples in comparison.Application of SA to gut metagenomes from women with type 2 diabetes T2D 17 reveals compositional features and a large collection of unique or abundant genes in T2D gut metagenomes some of the genes identified by SA were otherwise missed by direct assembly of the original datasets.

Therefore additional profiling of gene abundance is required in order to search for genes consistently more abundant in one group versus the other.In this paper we further developed the subtractive assembly approach for the detection of consistently differential genomes or genes by using k-mer frequencies in individual samples co-abundance.

Although reads extraction by CoSA resulted in a smaller collection of microbial genes than the SA approach since CoSA retained much fewer reads than SA genes from CoSA tend to be more consistently differential across the samples between the groups.


For the Bacteroidetes- left and Firmicutes- right specific tests the proportion of invariable blue non-significant gray and variable red gene families at an estimated 5 FDR using cutoffs from overall test.Pathways with at least five total gene families across both phyla are shown.Rectangular Venn diagrams showing the proportion ofBacteroidetes-specific left shared center bright and Firmicutes-specific right invariable blue and variable red gene families for each of the pathways enumerated in A. PDF 367 kb Module and pathway enrichments for gene families with invariable abundances in every phylum-specific test Fisher's exact test q  0.25.

Importantly since the majority of gene families annotated to LPS biosynthesis were invariable this result would have been missed by considering the pathway as a unit.Many invariable gene families are deeply conserved Conservation of gene families across the tree of life is one factor we might expect to affect gene variability.

Invariable gene families tended toagree but the reverse was true for variable gene families 19.4 of gene families that were invariable in one phy- lum were invariable in all compared to just 0.34 eight genes in the variable set Fig.

Proteobacteria-specific variable gene families tended to be variable overall 59 whereas the proportions ofgene families that were also variable overall were much lower for Bacteroidetes- 12 Firmicutes- 29 and Actinobacteria-specific 18 gene families Fig.

Empirically this measure is very similar to the number of protein sequences Additional file Figure S11 but is not as sensitive to high or variable rates of within-species duplication for example families such as transposons which exhibit high rates of duplica- tion as well as copy number variation between species have a larger number of sequences than even very well- conserved proteins such as RNA polymerase but have similar or even lower tree densities indicating that they are not truly more broadly conserved.Many protein families 8931 families did not have enough observations to reliably calculate tree density with almost all of these being annotated in only a singlebacterialarchaeal genome.

E. coli for Proteobacteria.Since estimates of average genome size made from the entire metagenome might differ from estimates made on specific clades only when performing the test we normal- ized for AGS by dividing gene family counts by the median abundance of a set of 29 bacterial single-copy marker gene families These gene families were filtered in the same phylum-specific way as all other gene families.

For example both low-abundance gene families with many zero values and high-abundance but invariable gene families will tend to have low residual variance but the evidence for invari- ability is much stronger for the second group.

Our test accurately discriminates between these scenarios tending to call the second group significantly invariable and not the first Additional file Figure S6A inset whereas an approach that simply thresholded VE would be unable toCCoDA can be applied to shotgun metagenomes to sen- sitively and specifically identify variable genes in any envi- ronment without prior knowledge of factors that stratify relatively high versus low abundance samples.Thousands of variable gene families in the gut microbiome Using CCoDA we found 2357 gene families with more variability than expected and 5432 with less leaving 9628 non-significant at an empirical FDR of 5 Additional file Figure S6A.

Restricting the analysis to gene families with at least one annotated representative from a bacterial or archaeal genome in KEGG we obtained 1219 sig- nificantly variable and 3813 significantly invariable gene families and 2194 non-significant.

However when considering the 30 families with significant enrichments for invariable or non-significant gene families there was no signifi- cant association between the degree of enrichment for variable genes and either prevalence r  -0.07 p  0.72 or abundance r  -0.1 p  0.58 Additional file Figure S12D-E.


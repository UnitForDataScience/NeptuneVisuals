for long contigs 3000 bp the fold difference in virfinder over virsorter tprs were lower on average 1.1 1.8 and 3.8 for 10 50 and 90 viral samples respectively.sensitivity of virfinder to mutationsbecause virfinder relies on nucleotide k-mer analyses and sequencing technologies can contain errors the sensitive of virfinder to mutations was tested.

virfinder furthermore identified several recently sequenced virus genomes after 1 january 2014 that virsorter did not and that have no nucleotide similarity to previously sequenced viruses demonstrating virfinder's potential advantage in identifying novel viral sequences.application of virfinder to a set of human gut metagenomes from healthy and liver cirrhosis patients reveals higher viral diversity in healthy individuals than cirrhosis patients.

the tool also outputs a statistical measure of how distinct it is fromtable 1 the number of fragments generated from the virus genomes discovered before and after 1 january 2014prokaryotic hosts contigs the p value from comparing the query score to the distribution of scores for all host contigs used in the training dataset.evaluation of virfinder with contigs subsampled from known virus and host genomesafter training the model virfinder was evaluated on equal numbers of viral and host contigs subsampled from genomes sequenced after 1 january 2014. to evalu- ate virfinder's performance we used receiver operating characteristic roc curves typically used to evaluate performance of classifiers.

within each contig size class auroc scores had nocomparison of virfinder and virsorter performancewe assessed the ability of virfinder to correctly identify viral contigs in comparison to virsorter the top per- forming viral classification tool both virsorter and virfinder were tested using the same set of evaluation contigs as above equal numbers of contigs subsampled from host and virus genomes sequenced after 1 january 2014. this provided a fair comparison as both methods use databases of viruses sequenced before 1 january 2014 to make their predictions.

virfinder uniquely predicted 4 vi- ruses that virsorter did not and virsorter correctly predicted 12 viruses that virfinder did not.we also assessed the ability of virfinder to identify novel viruses by excluding viruses that infect a particular group of hosts four major phyla and eight major gen- era and the hosts of that taxon group from the training dataset and then predicting those viruses from among mixed sets of subsampled virus and host contigs.

we note that users applying virfinder to eukaryotic host associated micro- biomes should first filtered out eukaryotic host sequences as virfinder may potentially misidentify those sequences as viral since eukaryotic sequences were not included in virfinder's training datasets.virfinder is trained using a logistic regression model with lasso regularization in order to enhance the predic- tion accuracy and interpretability.

for example for 1000 bp contigs theauprc of virfinder were 0.71 0.94 and 0.99 as viral fraction increases from 10 50 and 90. despite these trends virfinder still exhibit higher tprs than virsorter under almost all conditions tested the exception being a few cases when considering predictions on all contigs500 bp additional file figure s6.while virfinder shows better performance than virsorter we ultimately advocate for the development and use of future tools that combine the core principles of each tool k-mer and gene-based approaches to make even better predictions.

virfinder's performance in correctly identifying viral sequences was tested by training its machine learning model on sequences from host and viral genomes sequenced before 1 january 2014 and evaluating on sequences obtained after 1 january 2014.results virfinder had significantly better rates of identifying true viral contigs true positive rates tprs than virsorter the current state-of-the-art gene-based virus classification tool when evaluated with either contigs subsampled from complete genomes or assembled from a simulated human gut metagenome.

for example for contigs subsampled from complete genomes virfinder had 78- 2.4- and 1.8-fold higher tprs than virsorter for 1 3 and 5 kb contigs respectively at the same false positive rates as virsorter 0 0.003 and 0.006 respectively thus virfinder works considerably better for small contigs than virsorter.

virfinder is available at resultsto build and test virfinder two separate sets of viral and host sequences were used for training and testing of the machine learning tool refseq virus and prokaryotic genomes sequenced before 1 january 2014 for model training and after 1 january 2014 for testing.

overall these high auroc scores demonstrate the strong ability of our virfinder tool to correctly identify newly obtained viral sequences.metagenomic assembly produces contigs of various lengths ranging from hundreds of bp to 105 bp or more so we wanted to determine the sensitivity of virfinder's performance to different contig lengths used for training and evaluation.

by selecting the virfinder score threshold that produces the same fpr level as the corresponding virsorter results we then determined the true positive rate tpr for virfinder.

to make fair comparisons across scores predicted using dif- ferent models trained using contigs of different lengths virfinder p values rather than virfinder scores were used for generating roc curves and corresponding auroc scores.

when considering all contigs1000 bp however virfinder had significantly higher tprs than virsorter under all scenarios at equivalent fprs additional file figure s6.example application identification and analysis of viral communities in human gut metagenomes from a liver cirrhosis studywe applied the virfinder tool to study real human gut metagenomes of healthy and liver cirrhosis patients.

model results using virfinder binned contigs had a larger auroc score 0.87 than those for virsorter bins 0.77. the roc curve for virfinder was above that of virsor- ter for most of the plot fig.


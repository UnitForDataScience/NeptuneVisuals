For long contigs 3000 bp the fold difference in VirFinder over VirSorter TPRs were lower on average 1.1 1.8 and 3.8 for 10 50 and 90 viral samples respectively.Sensitivity of VirFinder to mutationsBecause VirFinder relies on nucleotide k-mer analyses and sequencing technologies can contain errors the sensitive of VirFinder to mutations was tested.

VirFinder furthermore identified several recently sequenced virus genomes after 1 January 2014 that VirSorter did not and that have no nucleotide similarity to previously sequenced viruses demonstrating VirFinder's potential advantage in identifying novel viral sequences.Application of VirFinder to a set of human gut metagenomes from healthy and liver cirrhosis patients reveals higher viral diversity in healthy individuals than cirrhosis patients.

Within each contig size class AUROC scores had noComparison of VirFinder and VirSorter performanceWe assessed the ability of VirFinder to correctly identify viral contigs in comparison to VirSorter the top per- forming viral classification tool Both VirSorter and VirFinder were tested using the same set of evaluation contigs as above equal numbers of contigs subsampled from host and virus genomes sequenced after 1 January 2014.

VirFinder uniquely predicted 4 vi- ruses that VirSorter did not and VirSorter correctly predicted 12 viruses that VirFinder did not.We also assessed the ability of VirFinder to identify novel viruses by excluding viruses that infect a particular group of hosts four major phyla and eight major gen- era and the hosts of that taxon group from the training dataset and then predicting those viruses from among mixed sets of subsampled virus and host contigs.

We note that users applying VirFinder to eukaryotic host associated micro- biomes should first filtered out eukaryotic host sequences as VirFinder may potentially misidentify those sequences as viral since eukaryotic sequences were not included in VirFinder's training datasets.VirFinder is trained using a logistic regression model with lasso regularization in order to enhance the predic- tion accuracy and interpretability.

VirFinder's performance in correctly identifying viral sequences was tested by training its machine learning model on sequences from host and viral genomes sequenced before 1 January 2014 and evaluating on sequences obtained after 1 January 2014.Results VirFinder had significantly better rates of identifying true viral contigs true positive rates TPRs than VirSorter the current state-of-the-art gene-based virus classification tool when evaluated with either contigs subsampled from complete genomes or assembled from a simulated human gut metagenome.

For example for contigs subsampled from complete genomes VirFinder had 78- 2.4- and 1.8-fold higher TPRs than VirSorter for 1 3 and 5 kb contigs respectively at the same false positive rates as VirSorter 0 0.003 and 0.006 respectively thus VirFinder works considerably better for small contigs than VirSorter.

VirFinder is available at ResultsTo build and test VirFinder two separate sets of viral and host sequences were used for training and testing of the machine learning tool RefSeq virus and prokaryotic genomes sequenced before 1 January 2014 for model training and after 1 January 2014 for testing.

The tool also outputs a statistical measure of how distinct it is fromTable 1 The number of fragments generated from the virus genomes discovered before and after 1 January 2014prokaryotic hosts contigs the p value from comparing the query score to the distribution of scores for all host contigs used in the training dataset.Evaluation of VirFinder with contigs subsampled from known virus and host genomesAfter training the model VirFinder was evaluated on equal numbers of viral and host contigs subsampled from genomes sequenced after 1 January 2014.

Overall these high AUROC scores demonstrate the strong ability of our VirFinder tool to correctly identify newly obtained viral sequences.Metagenomic assembly produces contigs of various lengths ranging from hundreds of bp to 105 bp or more so we wanted to determine the sensitivity of VirFinder's performance to different contig lengths used for training and evaluation.


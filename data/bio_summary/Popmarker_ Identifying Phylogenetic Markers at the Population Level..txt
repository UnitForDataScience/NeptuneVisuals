As orthologous gene whose sequence distance is corre- lated with the species tree can be a potential marker gene all 1-to-1 orthologous gene families were ranked by their correla- tion values in descending order PCC correlation as example in Supplementary Table S3.In the fourth step gene trees were reconstructed by concatenating the alignments of genes from Top1 to TopN concatenating the first gene to the Nth gene from the Species Rank to capture the evolutionary history of these species.

Species tree and reconstructed gene trees A a species tree using 2287 orthologous genes in 48 Vibrio harveyi clade B a reconstructed gene tree using orthologous sequences of top gene group eg Vca1114GL00502 a hypothetical protein in Vibrio campbellii 1114GL in the Species Rank with PCC metric C a reconstructed gene tree using concatenated alignment of top 4 orthologous sequences in the Species Rank with PCC metric and D a reconstructed gene tree using the orthologous sequences same to C and the top 12th group in the Vca-Clade Rank with PCC metric.

The advantages of our proposed method are as follows 1 each orthologous gene is scored by sequence dis- tance not by its gene tree topology to avoid the time-consuming in aligning sequences and reconstructing individual gene tree 2 weattempt to resolve the phylogeny not only at species level but also at population level 3 the reference species tree is reconstructed by phylogenomics using the concatenation of sequences of large number of single-copy orthologues identified by orthogroup inference programs 4 Popmarker is flexible in identifying mark- ers from protein or nucleotide sequences and 5 because the identification of orthologous genes has been widely used in genome comparison or phylogenomics in many different lineages of tree of life10-13 Popmarker can be inherently applied in any organism where its genome is available.

We found that the Top1 gene based on PCC 0.989 is a hypothetical protein eg Vca1114GL00502 in V. campbellii 1114GL and the Top1 gene based on Kendall and Spearman gave a same gene responsible for tetratricopeptide repeat- containing protein YfgC precursor eg Vca1114GL02775 inV.

PCC indicates Pearson correlation coefficient.Evaluating gene treesFinally the topologies of these reconstructed gene trees were evaluated by computing correlation distances between gene tree and species tree.

This step is option if users use a predefined tree instead.Rank proteins based on correlations between the species tree and sequence distances within the orthologous pro- teins step 3.1 andor between a subtree of some species of interest and the sequence distances of the orthologues in the subtree step 3.2.Reconstruct a phylogenetic tree gene tree using the top N proteins from the above rank.Compare the gene tree with the species tree.The overall commented workflow is shown in Figure 1 and the detailed methods are described as follows.Identify orthologous relationships and calculate sequence similaritiesFirst users need to provide all available geneprotein sequences in a number of species of interest say N species and identify orthologous sequence families using orthologous prediction tools such as OrthoMCL15 MultiParanoid16 and OrthoFinder.17 In our pipeline we provided a script orthoships.

The script maketree.py was provided to reconstruct a gene tree by either given the genes from Species Rank or genes com- pared with Clade Rank.Tree comparisonFor evaluating the similarity between the gene tree and the spe- cies tree the PCC was used for comparing the branch lengths tree vector T between both trees.

The above pipeline needs to replace all-to-all blastp with all-to-all blastn genes are then sorted in Species Rank and Claded Rank respec- tively and the gene tree is reconstructed similar to the proce- dure using protein sequences.Gene tree reconstructed using traditional molecular markersAs a comparison with the traditional molecular markers the gene trees of 16S rDNA recombinase A recA RNA poly- merase a subunit rpoA glyceraldehyde-3-phosphate dehy- drogenase a subunit gapA DNA gyrase b subunit gyrB and the concatenated sequences from these 5 genes were constructed by the same method as mentioned above.

For example the gene tree reconstructed by the Top1 gene selected by the PCC method showed thatV.

Moreover the phylogenetic relationships between species groups in the gene trees using Top2 Top3 Top4 or Top5 by the PCC method was the same as species tree and in some branches the lower support values in the gene trees were improved when combining more genes Figure 3C and Supplementary Figure S2.Figure 3.


subsequent factors will split the bins from previous steps and after n iterations one has n factors that can be mapped to the phylogeny n1 bins for binning taxa based on their phylogenetic factors n estimates of ilr balancing elements and an orthonormal ilr basis that can be used to project the data onto a lower dimensional space.

the balances in a rooted ilr transform in equation can be intuited as the average difference between taxa in two groups and splits in the tree which meaningfully differentiate taxa will be those splits in which the average difference between taxa in two groups changes predictably with an independent variable.

3 repeat steps 1 and 2 constructing subsequent ilr basis elements corresponding to remaining edges in the phylogeny and made orthogonal to all previous partitions by limiting the comparisons to taxa within the groups of taxa un-split by previous partitions.explicitly the first iteration of phylofactorization considers a set of candidate ilr coordinates xe corresponding to the two groups of taxa split by each edge e. then regression is performed on each of the ilr coordinates xe  f x  for an appropriate function f and a set of independent variables x .

the log-ratio used in phylofactor is an averaged ratio of abundances of taxa on two sides of an edge see for more detail thus phylofactorization searches the tree for the edge which has the most predictable difference between taxa on each side of the edge or put differently the edge which best differentiates taxa on each side.

the amount of variance explained was measured as the difference in the null deviance and the model deviance summed across all three factors or the top 3 ilr coordinates.ks-based stopping function for phylofactorwhile a researcher can iterate through phylofactorization until a full basis of d - 1 ilr coordinates is constructed the researcher may be interested in stopping the iteration before the full basis is constructed and focus their analysis and interpretations on a conservative subset of the true number of phylogenetic factors.

below we summarize the factors--the p-values from regression the taxa split ateach factor the body site associations predicted by generalized linear modeling of the ilr coordinate against body site and finer detail about the taxonomic identities and known ecology of monophyletic taxa being split.

unlike the previous three factors above which were acidophiles this monophyletic group of acidobacteria consists of alkaliphiles whichincludes the classes acidobacteria-6 chloracidobacteria s053 and three otus unclassified at the class level.the first four factors define 5 bins of otus that we refer to as ''binned phylogenetic units'' or bpus a monophyletic group of acidobacteria classes chloracidobacteria acidobacteria-6 and s035 another monophyletic group of acidobacteria classes solibacteres and tm1 a monophyletic group of several families of the order actinomycetales a monophyletic group of acidobacteria classes acidobacteriia and da0522 and a paraphyletic amalgamation of the remaining taxa.

a researcher interested in fine-tuning the evolutionary assumptions in phylofactorization can define an objective function that increases explicitly with the length of the edge being considered to reflect an assumption that the probability of a trait arising increases with the amount of time elapsed.each edge identified in phylofactorization corresponds to two bins of taxa on each side of the edge and consequently phylofactorization brings in two complementary perspectives for analyzing the data factor-based analysis and bin-based analysis.

factor-based analysis looks at the each factor as an inference on an edge in the phylogeny conditioned on the previous inferences already made and indicating that taxa on one side of an edge respond differently to the independent variable compared to taxa on the other side of the edge.

finally future research can investigate the unique kinds of errors in phylofactorization in addition to the multiple-hypothesis testing ofedges phylofactorization may propagate errors in the greedy algorithm and even when taxa are correctly factored into the appropriate functional bins the presence of multiple factors in the same region of the tree can lead to uncertainty about the exact edge along which a putative trait arose see for more discussion on the uncertainty of which edge to annotate.incorporating that phylogenetic structure into the analysis of microbiome datasets has been a major challenge  and now phylofactorization provides a general framework for rigorous exploration of phylogenetically-structured compositional datasets.

instead of principle components analysis or principle coordinates analysis phylofactorization can be used as for exploratory data analysis and dimensionality reduction tool in which the ''components'' are identifiable clades in the tree of life a far more intuitive and informative component for biological variation than multi-species loadings.phylofactorization can allow researchers to annotate online databases of the microbial tree of life permitting predictions about the physiology of unclassified and uncharacterizedlife forms based on previous phylogenetic inferences in sequence-count data.

performing inference on the edges in a phylogeny driving variation in the data can be useful for identifying clades with putative traits causing related taxa to respond similarly to treatments but such inferences must account for the compositional nature of the sequence-count data.a standard analysis of microbiome datasets uses only the distal edges of the tree--the otus--and a few edges within the tree separating linnaean taxonomic groups.

however a phylogeny of d taxa and no polytomies is composed of 2d - 3 edges each connecting two disjoint sets of taxa in the tree with no guarantee that splits in linnaean taxonomy corresponds to phylogenetic splits driving variation in our dataset.

to do that we draw on the isometric log-ratio transform from compositional data analysis which has been used to search for a taxonomic signature of obesity in the human gut flora  and incorporated into packages for downstream principal components analysis .

any polytomy will produce a split in the phylogeny between three or more taxa and there is no general way to describe the balance of relative abundances of three or more parts using only one coordinate.nonetheless the simplicity and theoretical foundations underlying the ilr and the instant appeal of applying it to the sequential-binary partition of the phylogeny motivate the rooted ilr as a simple tool for analysis of the phylogenetic structure in compositional data.


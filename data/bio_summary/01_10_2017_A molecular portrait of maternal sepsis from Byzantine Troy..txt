We mapped the libraries to a hard-masked hg38 refer- ence genome downloaded from the UCSC genome browser  and recorded the number of reads mapping to chrX chrY mitochondrial genome and all autosomes.

Damage patterns and fragment length distribution of ancient DNA mapped to mitochondrial genome can be found in -.Human nuclear genome analysesReads from four shotgun libraries three from the nodules Nod11 hrUDG Nod2-UDG Nod2-nonU one from the ulna Ulna-UDG were mapped and processed as described for the mitochondrial genome above.

Fragment length distributions for all pooled libraries and damage plots for the non-UDG treated libraries Nod11h-nonU and Nod2-nonU were calculated through mapDamage2   .Human mitochondrial genome analysesCASAVA processed reads see directly above from enriched ulna extractions UlnaEnr1-nonU UlnaEnr2-nonU shotgun reads from the UDG treated nodule extraction Nod11h-UDG and cor- responding extraction blanks EblkDEnr1-nonU EblkDEnr2-nonU and EblkA-UDG were processed as described above but mapped to the rCRS mitochondrial genome NC012920  .

For all libraries we additionally mapped to the S. saprophyticus ATCC 15305 NC007350 and G. vaginalis ATCC 14019 NC014644 with a customized version of the Burrows-Wheeler Aligner  obtained from with a maximum edit distance of 0.01 -n 0.01 allowing for no more than two gaps -o 2 and with seeding effectively disabled -l 16500 retaining only those mapped reads which were merged or properly paired  Molecules that were less than 35 bp in length had a mapping quality score of less than 30 or were marked as duplicates based on both 5' and 3' coordinates were removed We then pooled all nodule reads DNA originating from the shotgun DNA libraries Nod11h-UDG Nod11h-nonU Nod2-UDG Nod2-nonU and the S. saprophyticus and G. vaginalis mappings and further removed any duplicated molecules found between libraries .

Whole genome alignment of the Troy strain and de novo assemblies to ATCC 15305 was performed using Mugsy 2.3   RRIDDe novo assembly and annotation of S. saprophyticusThe draft genome sequences of Japanese isolates were obtained by de novo assembly using CLC genome workbench v8.02 RRIDFor North American and Australian S. saprophyticus genomes de novo assembly was performed using the iMetAMOS pipeline   RRID We compared assemblies from SPAdes  MaSurCA  and Velvet .

We used SplitsTree4  RRID to create networks of pSST1 the chromosome in S. saprophyticus and the core genome of G. vaginalis.RecombinationRecombination in a whole genome alignment of S. saprophyticus isolates and a core genome align- ment of modern G. vaginalis isolates was assessed using BratNextGen .

The S. saprophyticus Troy draft genome was reconstructed using iterative assembly to span gaps between contigs that were created from assembly to the S. saprophyticus reference genome NC007350.Trimmed reads from Nod1all-UDG were paired-end assembled to the S. saprophyticus reference NC007350 using BWA RRIDwith default settings  and dupli- cates were removed using samtools RRID rmdup .

saprophyticus Troy genome verificationAll potential reads were assembled to a penultimate draft version of the genome a combined product of reference-guided assembly consensus contigs iterative de novo assembly and manual curation as noted.

vaginalis from paired end-assemblies are listed in .Bacterial genome coverage and DNA damage estimationsTo most conservatively assess the abundance coverage and authenticity of our ancient reads we ran a subset of analyses using slightly more stringent criteria.

The primary set of reads used for iterative assembly was generated by trimming 100 bp from each end of the contigs assembling all original reads using the above settings to this set of trimmed contigs and removing these assembled reads from consid- eration.


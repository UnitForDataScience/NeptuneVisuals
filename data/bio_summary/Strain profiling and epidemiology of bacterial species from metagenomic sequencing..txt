The strain identifiers are reported in d. b To verify that complex strain mixtures are not an artifact due to the presence of one strain not represented in the collection of genomic reference sequences we show for three representative samples the distribution of frequencies of the four possible nucleotides at each allelic position.

In particular while at the beginning of the sampling period we found that a strain closely related to strain 504SEPI was dominant at later times there was a switch to strain 236SEPI confirming thefindings of the original publication.

6 where we found that in all cases the strain distribution was reconstructed with high precision with an aver- age MCC 0.96 strains with relative predicted abundance below 1 were not considered in the comparison and an average Jensen-Shannon divergence JSD  0.02 for a total coverage of 100X Supplementary Tables 1 and 2.One of the major challenges of reference-based methods is when a strain is missing from the reference database.

b Whole-genome cladogram of the reference genomes also including the two high-quality genome sequences Sharon strain 1 and Sharon strain 3 assembled in the original paper from the same samples.

This guarantees that if the sample contains a strain that is divergent from all the sequences in the reference database StrainEst will not try to model it as a superposition of reference strains.

The repre- sentative sequences of these clusters were assigned to one of the six phylogenetic groups according to their Mash distance from the reference strain of each group namely E. coli str.

For all species StrainEst identified correctly the presence of one dominant strain that coincided with the strain known to be present with the exception of N. meningitidis in sample SRR172903 where the algorithm did not reach convergence due to the low number of reads that aligned to the referencea10xb100x11.000.750.500.250.001.000.750.502345678910123456789100.250.001.000.750.500.250.00c14x6xd12x6x 2xe8x6x4x 2xMethodMethodMethodFig.

In agreement with the strain pattern reconstructed by StrainEst we found that for samples predicted to harbor a single strain the distribution was bimodal with allelic variants either supported by 100 of the reads or not present.

While the three initial samples were dominated by strain 504SEPI at later times strain 236SEPI was the most abundant.

To eliminate spurious sequences the genome database was filtered discarding those sequences too divergent from the NCBI type strain of the species and clustered to reduce the redundancy of closely related genomes see Methods section.Computing the core genome and the reference SNV profiles.

